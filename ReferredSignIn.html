<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>CompliSpace Fundamentals Referred Sign In - CompliSpace Developer Blog</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="author" content="@AlchemyCS <https://github.com/alchemycs>" />
    <meta name="description" content="CompliSpace Technology Developer Blog" />
    <meta name="google-site-verification" content="ev8un4h3Ma9ur_slllwMdjTgznoE7MRbZy_-OpjWMpc" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    
    <!-- Le styles -->
    <link href="/css/bootstrap.css" rel="stylesheet">
    <style type="text/css">
      body {
        padding-top: 60px;
        padding-bottom: 40px;
      }
      .sidebar-nav {
        padding: 9px 0;
      }
    </style>
    <link href="/css/bootstrap-responsive.css" rel="stylesheet">
    <link href="http://coderwall.com/stylesheets/jquery.coderwall.css" media="all" rel="stylesheet" type="text/css">

    <!-- Le HTML5 shim, for IE6-8 support of HTML5 elements -->
    <!--[if lt IE 9]>
      <script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <!-- Le fav and touch icons -->
    <link rel="shortcut icon" href="/favicon.ico">
    <link rel="apple-touch-icon" href="/apple-touch-icon.png">
        
    <!-- More ideas for your <head> here: h5bp.com/d/head-Tips -->
    <link rel="alternate" type="application/rss+xml" title="RSS" href="/blog-feed.xml">    
    <link rel="author" href="/humans.txt" />
    
  </head>

  <body>

    <div class="navbar navbar-fixed-top">
      <div class="navbar-inner">
        <div class="container-fluid">
          <a class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse">
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </a>
          <a class="brand" href="/">CompliSpace Developer Blog</a>
          <div class="nav-collapse">
            <ul class="nav">
<!--                <li class=""><a href="/index.html" title="View the 5 most recent posts">Recent Posts</a></li>
                <li><a href="/Archives.html" title="View a list of all the CompliSpace Developer posts">All Posts</a></li>-->
                <!--<li><a href="http://q2a.complispace.net/" target="q2a" title="Ask questions about the CompliSpace Fundamentals program and receive answers from CompliSpace staff and other expert users">Q <sub>2</sub> A</a></li>-->
                <!--                    <li><a href="/blog-feed.xml">RSS Feed</a></li>-->
            </ul>
          </div>
          <!--/.nav-collapse -->
        </div>
      </div>
    </div>

    <div class="container-fluid">
      <div class="row-fluid">
        <div class="span3">
<!--          <div class="well sidebar-nav">
            <ul class="nav nav-list">
              <li class="nav-header">Previous Posts</li>
                
                <li>
                <a href="/update/2013/10/09/September-Updates.html">September Fundamentals Updates</a> - <em><time datetime="2013-10-09" pubdate>Posted on 09 Oct 2013</time></em>
                </li>
                
                <li>
                <a href="/update/2013/08/27/August-Updates.html">August Fundamentals Updates</a> - <em><time datetime="2013-08-27" pubdate>Posted on 27 Aug 2013</time></em>
                </li>
                
                <li>
                <a href="/update/2013/07/31/June-Updates.html">June Fundamentals Updates</a> - <em><time datetime="2013-07-31" pubdate>Posted on 31 Jul 2013</time></em>
                </li>
                
                <li>
                <a href="/update/2013/05/17/May-Updates.html">May Fundamentals Updates</a> - <em><time datetime="2013-05-17" pubdate>Posted on 17 May 2013</time></em>
                </li>
                
                <li>
                <a href="/article/2012/12/14/Browser-Support-For-2013.html">Browser Support For 2013</a> - <em><time datetime="2012-12-14" pubdate>Posted on 14 Dec 2012</time></em>
                </li>
                            
            </ul>
          </div>-->
            <!--/.well -->
          <div class="well sidebar-nav">
              <ul class="nav nav-list">
                  <li class="nav-header">Important Information</li>
                  <li><a href="/SSO-For-CompliSpace-Fundamentals.html">Using SAML 2.0 for SSO</a></li>
                  <li><a href="/ReferredSignIn.html">Using Referred Signin for SSO</a></li>
                  <li><a href="/article/2012/12/14/Browser-Support-For-2013.html">Browser Support For 2013</a></li>
                  <li><a href="/article/2011/11/29/Fundamentals-Supported-File-Types.html">Supported File Types</a></li>
                  <!--<li><a href="/article/2011/11/10/Community-Questions-And-Answers.html">Community Driven "Questions To Answers"</a></li>-->
                  <li><a href="/article/2012/08/01/Receive-Emails-From-CompliSpace-Fundamentals.html">Receive Emails From CompliSpace Fundamentals</a></li>
              </ul>
          </div>
          <div class="well sidebar-nav">
              <ul class="nav nav-list">
                  <li class="nav-header">Interesting Links</li>
                  <li><a href="http://gamejolt.com/profile/michael-mchugh/292948/">Games</a> - Games written by the CompliSpace CTO</li>
                  <li><a href="http://www.watersideresortpranburi.com/">Waterside Resort</a> - Resort in Thailand run by the CTO's family</li>
                  <li><a href="http://www.earthexplorer.info">Earth Explorer</a> - Explore the world</li>
                  <li><a href="http://ivory-breeze.herokuapp.com">Ivory Breeze</a> - Extract keywords and locations from text and websites</li>
                  
              </ul>
          </div>
          <hr/>
          <section class="coderwall" data-coderwall-username="alchemycs" data-coderwall-orientation="horizontal"></section>
        </div><!--/span-->
        <div class="span9">
          <div class="hero-unit hidden">
            <h1>CompliSpace Technology</h1>
            <p>A place for CompliSpace Technology.</p>
            <p><a class="btn btn-primary btn-large" href="http://www.complispace.com.au">Learn more &raquo;</a></p>
          </div>
          <div class="row-fluid">
            <div class="span12">

                
<h1>CompliSpace Fundamentals Referred Sign In</h1>  
<h2 id='introduction'>Introduction</h2>

<p>For better integration into existing client sites, CompliSpace has implemented a simplified method for signing in to Fundamentals sites.</p>

<p>This is accomplished by allowing an organisation&#8217;s internal sites to generate signed links that signify to Fundamentals that the user is already trusted by the referring site.</p>

<p>Helper classes/sample code is available on <a href='https://github.com/CompliSpace'>GitHub</a> as <a href='https://gist.github.com/907000'>GIST 907000</a>. The sample code is available in <a href='https://gist.github.com/907000#file_csf_referrer.class.php'>PHP</a>, <a href='https://gist.github.com/907000#file_csf_referrer.cs'>C# .NET</a>, <a href='https://gist.github.com/907000#file_csf_referrer.js'>Node.js (JavaScript)</a> and <a href='https://gist.github.com/907000#file_csf_referrer.py'>Python</a>.</p>

<h2 id='implementation'>Implementation</h2>

<p>The implementation consists of appending several <code>GET</code> request parameters that are signed by a secret key.</p>
<div class='alert alert-error'>
<p>
<h4>ATTENTION:</h4> The secret key MUST NEVER be exposed to the client browser.
URL generation MUST be done server side.
</p>
<p>
Exposing the secret key will compromise the security of your site, and possibly
breach the terms of your contract with CompliSpace.
</p>
</div>
<p>If you would like to use this feature, please contact CompliSpace and request a <mark>Referred Sign In Private Key</mark>.</p>

<p>To use the referred login mechanism for CompliSpace Fundamentals, simply link to the regular page you want people to view (eg, <a href='http://xyz.complispace.com.au/HRAdministrationManagersOnly'>http://xyz.complispace.com.au/HRAdministrationManagersOnly</a>) and append the following <code>GET</code> parameters:</p>
<pre class='note'><code>referredUserLogin=&lt;login username&gt;
referredExpires=&lt;unix epoch timestamp, must be no greater than 6 hours in the 
future&gt;referredAccessKeyId=&lt;your sites key id&gt;referredSignature=&lt;
base 64 encoded calculated signature of the request&gt;
</code></pre>
<p>The <code>referredSignature</code> is calculated with the following pseudo-code:<br /><pre class='note'><code>$stringToSign = (sting)$referedUserLogin+":"+(string)$referredExpires+":"+(string)$secretAccessKey;
$referredSignature = base64_encode(hash_hmac("sha256", $stringToSign, $secretAccessKey));
</code></pre></p>

<p>Note that for this implementation the output of the <code>hash_hmac()</code> function is expected to be a lowercase string of hex digits (<a href='http://au2.php.net/hash_hmac'>see the hash_hmac() PHP function</a>).</p>

<p>Example (pseudo code):</p>
<pre class='note'><code>referredUserLogin=bob (the user who is accessing the site)
referredExpires=1320969600  (11am, 11th November 2011 - <a href='http://www.awm.gov.au/commemoration/remembrance/'>rememberance day</a>)
referredAccessKeyId=mySiteId (the key that identifies the signer)
secretAccessKey=connie (the secret, unshared key used to sign the request)
</code></pre><p />
<ol>
<li>Calculate the string to sign:<br /><code>$stringToSign = &quot;bob:1320969600:mySiteId&quot;;</code></li>

<li>Create the signature:<br /><code>$signature = hash_hmac(&quot;sha256&quot;, &quot;bob:1320969600:mySiteId&quot;, &quot;connie&quot;);</code><br />The result will be <code>7435b9129f07a93f790875f061c9396b27cf5d6bb5be8cf7b37afacd11dd00ca</code></li>

<li>Base64 encode the signature:<br /><code>$signature = base64_encode($signature);</code><br />The result will be <code>NzQzNWI5MTI5ZjA3YTkzZjc5MDg3NWYwNjFjOTM5NmIyN2NmNWQ2YmI1YmU4Y2Y3YjM3YWZhY2QxMWRkMDBjYQ==</code></li>

<li>Build the url:<br /><pre class='note'><code>$url = sprintf("http://xyz.complispace.com.au/Home?referredUserLogin=%s&referredExpires=%s&referredAccessKeyId=%s&referredSignature=%s", $referredUserLogin, $referredExpires, $referredAccessKeyId, $signature);</code></pre></li>
</ol>
<p />
<p>This will result in the final URL:</p>
<pre class='note'><code>http://xyz.complispace.com.au/Home?referredUserLogin=bob&referredExpires=1320969600&referredAccessKeyId=connie&referredSignature=NzQzNWI5MTI5ZjA3YTkzZjc5MDg3NWYwNjFjOTM5NmIyN2NmNWQ2YmI1YmU4Y2Y3YjM3YWZhY2QxMWRkMDBjYQ==
</code></pre>
<p>If you have any questions or feedback, please contact <a href='mailto:development@complispace.net'>&#100;&#101;&#118;&#101;&#108;&#111;&#112;&#109;&#101;&#110;&#116;&#064;&#099;&#111;&#109;&#112;&#108;&#105;&#115;&#112;&#097;&#099;&#101;&#046;&#110;&#101;&#116;</a></p>

            </div><!--/span-->
          </div><!--/row-->
        </div><!--/span-->
      </div><!--/row-->

      <hr>

    <footer >
        <div class="row-fluid">
            <div class="span4">
                <ul class="unstyled">
    <!--                    <li><a href="http://twitter.com/CompliSpace/"><img src="/images/sm/twitter.png"/> Twitter</a></li>-->
                    <li><a href="http://twitter.com/AlchemyCS/"><img src="/images/sm/twitter.png" alt="Twitter:"/> @AlchemyCS</a></li>
    <!--                    <li><a href="http://complispace.wordpress.com/"><img src="/images/sm/wordpress-blue.png"/> Wordpress</a></li>-->
    <!--                    <li><a href="http://www.linkedin.com/company/494386"><img src="/images/sm/linkedin.png"/> LinkedIN</a></li>-->
                    <li><a href="http://www.linkedin.com/in/mrmchugh"><img src="/images/sm/linkedin.png" alt="LinkedIN: "/> LinkedIN</a></li>
                    <li><a href="mailto:&#100;&#101;&#118;&#101;&#108;&#111;&#112;&#101;&#114;&#064;&#099;&#111;&#109;&#112;&#108;&#105;&#115;&#112;&#097;&#099;&#101;&#046;&#110;&#101;&#116;"><img src="/images/sm/email.png" alt="email: " >&#100;&#101;&#118;&#101;&#108;&#111;&#112;&#101;&#114;&#064;&#099;&#111;&#109;&#112;&#108;&#105;&#115;&#112;&#097;&#099;&#101;&#046;&#110;&#101;&#116;</a></li>
                </ul>
            </div>
            <div class="span4" style="">            
                <address>
                    <strong>Sydney</strong><br/>
                    Level 1<br/>
                    191 Clarence Street<br/>
                    Sydney NSW 2000<br/>
                    <br/>
                    t: +61 2 9299 6105<br/>
                    f: +61 2 9299 2805
                </address>
            </div>
            <div class="span4" style="">
                <address>
                    <strong>Perth</strong><br/>
                    Level 18, Central Park<br/>
                    152-158 St Georges Terrace<br/>
                    Perth WA 6000<br/>
                    <br/>
                    t: +61 8 9288 1826<br/>
                    f: +61 8 9288 1827
                </address>
            </div>
        </div>
    </footer>
    </div><!--/.fluid-container-->

    <!-- Le javascript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script src="/js/libs/jquery-1.7.2.min.js"></script>
    <script src="/js/libs/bootstrap.min.js"></script>

    <!-- scripts concatenated and minified via build script -->
    <script  src="/js/plugins.js"></script>
    <script  src="/js/script.js"></script>
    <script src="http://coderwall.com/javascripts/jquery.coderwall.js"></script>    
    <!-- end scripts -->

    <!-- Asynchronous Google Analytics snippet. Change UA-XXXXX-X to be your site's ID.
       mathiasbynens.be/notes/async-analytics-snippet -->
    <script>
    var _gaq=[['_setAccount','UA-21489748-1'],['_trackPageview'],['_trackPageLoadTime']];
    (function(d,t){var g=d.createElement(t),s=d.getElementsByTagName(t)[0];
    g.src=('https:'==location.protocol?'//ssl':'//www')+'.google-analytics.com/ga.js';
    s.parentNode.insertBefore(g,s)}(document,'script'));
    </script>
    
    <!-- Prompt IE 6 users to install Chrome Frame. Remove this if you want to support IE 6.
       chromium.org/developers/how-tos/chrome-frame-getting-started -->
    <!--[if lt IE 7 ]>
    <script defer src="//ajax.googleapis.com/ajax/libs/chrome-frame/1.0.3/CFInstall.min.js"></script>
    <script defer>window.attachEvent('onload',function(){CFInstall.check({mode:'overlay'})})</script>
    <![endif]-->


  </body>
</html>
