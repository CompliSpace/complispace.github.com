<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>SAML Single Sign On (SSO) Service for CompliSpace Fundamentals - CompliSpace Developer Blog</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="author" content="@AlchemyCS <https://github.com/alchemycs>" />
    <meta name="description" content="CompliSpace Technology Developer Blog" />
    <meta name="google-site-verification" content="ev8un4h3Ma9ur_slllwMdjTgznoE7MRbZy_-OpjWMpc" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    
    <!-- Le styles -->
    <link href="/css/bootstrap.css" rel="stylesheet">
    <style type="text/css">
      body {
        padding-top: 60px;
        padding-bottom: 40px;
      }
      .sidebar-nav {
        padding: 9px 0;
      }
    </style>
    <link href="/css/bootstrap-responsive.css" rel="stylesheet">
    <link href="http://coderwall.com/stylesheets/jquery.coderwall.css" media="all" rel="stylesheet" type="text/css">

    <!-- Le HTML5 shim, for IE6-8 support of HTML5 elements -->
    <!--[if lt IE 9]>
      <script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <!-- Le fav and touch icons -->
    <link rel="shortcut icon" href="/favicon.ico">
    <link rel="apple-touch-icon" href="/apple-touch-icon.png">
        
    <!-- More ideas for your <head> here: h5bp.com/d/head-Tips -->
    <link rel="alternate" type="application/rss+xml" title="RSS" href="/blog-feed.xml">    
    <link rel="author" href="/humans.txt" />
    
  </head>

  <body>

    <div class="navbar navbar-fixed-top">
      <div class="navbar-inner">
        <div class="container-fluid">
          <a class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse">
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </a>
          <a class="brand" href="/">CompliSpace Developer Blog</a>
          <div class="nav-collapse">
            <ul class="nav">
<!--                <li class=""><a href="/index.html" title="View the 5 most recent posts">Recent Posts</a></li>
                <li><a href="/Archives.html" title="View a list of all the CompliSpace Developer posts">All Posts</a></li>-->
                <!--<li><a href="http://q2a.complispace.net/" target="q2a" title="Ask questions about the CompliSpace Fundamentals program and receive answers from CompliSpace staff and other expert users">Q <sub>2</sub> A</a></li>-->
                <!--                    <li><a href="/blog-feed.xml">RSS Feed</a></li>-->
            </ul>
          </div>
          <!--/.nav-collapse -->
        </div>
      </div>
    </div>

    <div class="container-fluid">
      <div class="row-fluid">
        <div class="span3">
<!--          <div class="well sidebar-nav">
            <ul class="nav nav-list">
              <li class="nav-header">Previous Posts</li>
                
                <li>
                <a href="/update/2013/10/09/September-Updates.html">September Fundamentals Updates</a> - <em><time datetime="2013-10-09" pubdate>Posted on 09 Oct 2013</time></em>
                </li>
                
                <li>
                <a href="/update/2013/08/27/August-Updates.html">August Fundamentals Updates</a> - <em><time datetime="2013-08-27" pubdate>Posted on 27 Aug 2013</time></em>
                </li>
                
                <li>
                <a href="/update/2013/07/31/June-Updates.html">June Fundamentals Updates</a> - <em><time datetime="2013-07-31" pubdate>Posted on 31 Jul 2013</time></em>
                </li>
                
                <li>
                <a href="/update/2013/05/17/May-Updates.html">May Fundamentals Updates</a> - <em><time datetime="2013-05-17" pubdate>Posted on 17 May 2013</time></em>
                </li>
                
                <li>
                <a href="/article/2012/12/14/Browser-Support-For-2013.html">Browser Support For 2013</a> - <em><time datetime="2012-12-14" pubdate>Posted on 14 Dec 2012</time></em>
                </li>
                            
            </ul>
          </div>-->
            <!--/.well -->
          <div class="well sidebar-nav">
              <ul class="nav nav-list">
                  <li class="nav-header">Important Information</li>
                  <li><a href="/SSO-For-CompliSpace-Fundamentals.html">Using SAML 2.0 for SSO</a></li>
                  <li><a href="/ReferredSignIn.html">Using Referred Signin for SSO</a></li>
                  <li><a href="/article/2012/12/14/Browser-Support-For-2013.html">Browser Support For 2013</a></li>
                  <li><a href="/article/2011/11/29/Fundamentals-Supported-File-Types.html">Supported File Types</a></li>
                  <!--<li><a href="/article/2011/11/10/Community-Questions-And-Answers.html">Community Driven "Questions To Answers"</a></li>-->
                  <li><a href="/article/2012/08/01/Receive-Emails-From-CompliSpace-Fundamentals.html">Receive Emails From CompliSpace Fundamentals</a></li>
              </ul>
          </div>
          <div class="well sidebar-nav">
              <ul class="nav nav-list">
                  <li class="nav-header">Interesting Links</li>
                  <li><a href="http://gamejolt.com/profile/michael-mchugh/292948/">Games</a> - Games written by the CompliSpace CTO</li>
                  <li><a href="http://www.watersideresortpranburi.com/">Waterside Resort</a> - Resort in Thailand run by the CTO's family</li>
                  <li><a href="http://www.earthexplorer.info">Earth Explorer</a> - Explore the world</li>
                  <li><a href="http://ivory-breeze.herokuapp.com">Ivory Breeze</a> - Extract keywords and locations from text and websites</li>
                  
              </ul>
          </div>
          <hr/>
          <section class="coderwall" data-coderwall-username="alchemycs" data-coderwall-orientation="horizontal"></section>
        </div><!--/span-->
        <div class="span9">
          <div class="hero-unit hidden">
            <h1>CompliSpace Technology</h1>
            <p>A place for CompliSpace Technology.</p>
            <p><a class="btn btn-primary btn-large" href="http://www.complispace.com.au">Learn more &raquo;</a></p>
          </div>
          <div class="row-fluid">
            <div class="span12">

                
<h1>SAML Single Sign On (SSO) Service for CompliSpace Fundamentals</h1>  
<h2 id='introduction'>Introduction</h2>

<p>Security Assertion Markup Language (SAML) is an XML standard that allows secure web domains to exchange user authentication and authorisation data. Using SAML, an online service provider can contact a separate online identity provider to authenticate users who are trying to access secure content.</p>

<p>CompliSpace Fundamentals offers a SAML based Single Sign-On (SSO) service that provides customers with full control over the authorisation and authentication of hosted user accounts that can access the CompliSpace Fundamentals web-based application. Using the SAML model, CompliSpace acts as the service provider and provides services such as Fundamentals. CompliSpace customers act as <strong>identity providers</strong> and control usernames, passwords and other information used to identify, authenticate and authorise users for web applications that CompliSpace hosts. There are a number of existing <a href='https://developers.google.com/google-apps/help/open-source#sso'>open source</a> and <a href='http://www.google.com/enterprise/marketplace/search?categoryId=2&amp;orderBy=rating'>commercial</a> identity provider solutions that can help you implement SSO with CompliSpace Fundamentals.</p>

<p>The CompliSpace SSO service is based on the <a href='http://www.oasis-open.org/committees/tc_home.php?wg_abbrev=security#samlv20'>SAML v2.0 specifications</a>. SAML v2.0 is supported by several widely known vendors.</p>
<div class='alert alert-info'>
    CompliSpace Technology supports this single sign-on experience as the integration 
    of a SAML 2.0 compliant Identity Provider (IdP) you have already installed and made operational. 
    CompliSpace Technology will do it's best to provide support with the SAML protocol, however 
    your Identity Provider (IdP) is a third-party product and therefore CompliSpace Technology
    does not provide detailed support for the deployment, configuration, troubleshooting, best practices, etc. 
    Issues and questions regarding your Identity Provider (IdP) should be directed to
    your vendor.
</div>
<h2 id='understanding_saml_based_sso_for_complispace_fundamentals'>Understanding SAML based SSO for CompliSpace Fundamentals</h2>

<p>The following process explains how a user logs into the CompliSpace Fundamentals application through an organisation&#8217;s, SAML based SSO service.</p>

<p>Figure 1, shown below, illustrates the process by which a user logs in to the CompliSpace Fundamentals application through a SAML based SSO service. The numbered list that follows the image explains each step in more detail.</p>
<div class='alert'>
<b>Note:</b> Before this process takes place, the organisation must provide CompliSpace with the <i>metadata XML</i> for their IdP. CompliSpace will also provide the organisation the <i>metadata XML</i> for the Fundamentals SP.
</div>
<p><strong>Figure 1: Logging in to CompliSpace Fundamentals using SAML</strong></p>

<p><img src='/images/saml-transaction-steps.png' alt='SAML Transaction Steps' /></p>

<p>This image illustrates the following steps:</p>

<ol>
<li>The user attempts to reach the CompliSpace Fundamentals application.</li>

<li>CompliSpace generates a SAML authentication request. The SAML request is encoded and embedded into the URL for the organisation&#8217;s SSO service. The RelayState parameter containing the encoded URL of the CompliSpace Fundamentals site that the user is trying to reach is also embedded in the SSO URL. This RelayState parameter is meant to be an opaque identifier that is passed back without any modification or inspection.</li>

<li>CompliSpace sends a redirect to the user&#8217;s browser. The redirect URL includes the encoded SAML authentication request that should be submitted to the organisation&#8217;s SSO service.</li>

<li>The organisation decodes the SAML request and extracts the URL for both CompliSpace&#8217;s ACS (Assertion Consumer Service) and the user&#8217;s destination URL (RelayState parameter). The organisation then authenticates the user. Organisations could authenticate users by either asking for valid login credentials or by checking for valid session cookies.</li>

<li>The organisation generates a SAML response that contains the authenticated user&#8217;s username and other details. In accordance with the SAML 2.0 specification, this response is digitally signed with the organisations&#8217;s public and private DSA/RSA keys.</li>

<li>The organisation encodes the SAML response and the RelayState parameter and returns that information to the user&#8217;s browser. The organisation provides a mechanism so that the browser can forward that information to CompliSpace&#8217;s ACS. For example, the organisation could embed the SAML response and destination URL in a form and provide a button that the user can click to submit the form to CompliSpace. The organisation could also include JavaScript on the page that automatically submits the form to CompliSpace.</li>

<li>CompliSpace&#8217;s ACS verifies the SAML response using the organisation&#8217;s public key. If the response is successfully verified, ACS redirects the user to the destination URL.</li>

<li>The user has been redirected to the destination URL and is logged in to CompliSpace Fundamentals.</li>
</ol>

<h2 id='required_assertions'>Required Assertions</h2>

<p>CompliSpace Fundamentals requires several claims/assertions that your SAML IdP must provide in order to work correctly. These can be provided using either the <code>short name</code>, <code>url scheme</code> or <code>urn oid</code></p>

<p>The claims in the <code>short name</code> format include:</p>

<ul>
<li><code>givenName</code> - The first name of the user</li>

<li><code>sn</code> - The surname of the user</li>

<li><code>mail</code> - The email address used by the user</li>

<li><code>objectGUID</code> - A unique identifer for the user that is persistent even if the user changes name or email address</li>

<li><code>memberOf</code> - The list of groups the user belongs in the <em>Distinguished Name</em> (DN) format or as a simple string.</li>
</ul>

<p>For the full list of claim maps in all formats, please see the Google Sheets Document, <a href='https://docs.google.com/spreadsheets/d/1yMnq7leUjX-iulmQecVv3_HMIHxqGjOOHBNFNDCSi_g/edit?usp=sharing'>SAML Required Attributes</a></p>

<h2 id='working_with_permissions_and_groups'>Working with Permissions and Groups</h2>

<p>CompliSpace Fundamentals has a rather thorough permissions system, but has been simplified for integration with SSO. First, if you want a user to have any kind of access to Fundamentals they must belong to a group called <code>Fundamentals</code>. This allows you to temporarily remove access to a user without having to remove and re-add all the detailed permissions.</p>

<p>Fundamentals partitions content into <em>sections</em> such as <em>Public</em> (available to all staff), <em>HR Admin</em> (only available for your Human Resources staff), etc. Please contact your CRM for details on sections availble to your installation. A user with access to a section may have <em>read only (RO)</em> or <em>read/write (RW)</em> access.</p>

<p>Section access is granted by ensuring the user belongs to a group that is made by taking the <code>section name</code> and appending either <code>RO</code> or <code>RW</code> as required for the access they require.</p>

<p>For example, if you wish for a user to have read only access to the Public section then they must belong to a group called <code>Public RO</code>. Should the user require read/write access then they must belong to a group called <code>Public RW</code>.</p>

<p>All characters in a group must match exactly. For example, the section called <code>Human Resources (Admin Only)</code> can be granted read only access to a user by assigning them to a group called <code>Human Resources (Admin Only) RO</code></p>

<h3 id='group_format'>Group Format</h3>

<p>The format for the group name can be either a simple string or in the <strong>Distinguished Name (DN)</strong> format.</p>

<p>With the DN format, only the <strong>CN</strong> RDN component is used.</p>

<p>Example: <code>CN=Human Resource (Admin Only) RO,OU=Fundamentals,OU=CompliSpace,OU=Vendors,DC=complispace,DC=net</code></p>

            </div><!--/span-->
          </div><!--/row-->
        </div><!--/span-->
      </div><!--/row-->

      <hr>

    <footer >
        <div class="row-fluid">
            <div class="span4">
                <ul class="unstyled">
    <!--                    <li><a href="http://twitter.com/CompliSpace/"><img src="/images/sm/twitter.png"/> Twitter</a></li>-->
                    <li><a href="http://twitter.com/AlchemyCS/"><img src="/images/sm/twitter.png" alt="Twitter:"/> @AlchemyCS</a></li>
    <!--                    <li><a href="http://complispace.wordpress.com/"><img src="/images/sm/wordpress-blue.png"/> Wordpress</a></li>-->
    <!--                    <li><a href="http://www.linkedin.com/company/494386"><img src="/images/sm/linkedin.png"/> LinkedIN</a></li>-->
                    <li><a href="http://www.linkedin.com/in/mrmchugh"><img src="/images/sm/linkedin.png" alt="LinkedIN: "/> LinkedIN</a></li>
                    <li><a href="mailto:&#100;&#101;&#118;&#101;&#108;&#111;&#112;&#101;&#114;&#064;&#099;&#111;&#109;&#112;&#108;&#105;&#115;&#112;&#097;&#099;&#101;&#046;&#110;&#101;&#116;"><img src="/images/sm/email.png" alt="email: " >&#100;&#101;&#118;&#101;&#108;&#111;&#112;&#101;&#114;&#064;&#099;&#111;&#109;&#112;&#108;&#105;&#115;&#112;&#097;&#099;&#101;&#046;&#110;&#101;&#116;</a></li>
                </ul>
            </div>
            <div class="span4" style="">            
                <address>
                    <strong>Sydney</strong><br/>
                    Level 4<br/>
                    179 Elizabeth Street<br/>
                    Sydney NSW 2000<br/>
                    <br/>
                    t: +61 2 9299 6105<br/>
                    f: +61 2 9299 2805
                </address>
            </div>
            <div class="span4" style="">
                <address>
                    <strong>Perth</strong><br/>
                    Level 18, Central Park<br/>
                    152-158 St Georges Terrace<br/>
                    Perth WA 6000<br/>
                    <br/>
                    t: +61 8 9288 1826<br/>
                    f: +61 8 9288 1827
                </address>
            </div>
        </div>
    </footer>
    </div><!--/.fluid-container-->

    <!-- Le javascript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script src="/js/libs/jquery-1.7.2.min.js"></script>
    <script src="/js/libs/bootstrap.min.js"></script>

    <!-- scripts concatenated and minified via build script -->
    <script  src="/js/plugins.js"></script>
    <script  src="/js/script.js"></script>
    <script src="http://coderwall.com/javascripts/jquery.coderwall.js"></script>    
    <!-- end scripts -->

    <!-- Asynchronous Google Analytics snippet. Change UA-XXXXX-X to be your site's ID.
       mathiasbynens.be/notes/async-analytics-snippet -->
    <script>
    var _gaq=[['_setAccount','UA-21489748-1'],['_trackPageview'],['_trackPageLoadTime']];
    (function(d,t){var g=d.createElement(t),s=d.getElementsByTagName(t)[0];
    g.src=('https:'==location.protocol?'//ssl':'//www')+'.google-analytics.com/ga.js';
    s.parentNode.insertBefore(g,s)}(document,'script'));
    </script>
    
    <!-- Prompt IE 6 users to install Chrome Frame. Remove this if you want to support IE 6.
       chromium.org/developers/how-tos/chrome-frame-getting-started -->
    <!--[if lt IE 7 ]>
    <script defer src="//ajax.googleapis.com/ajax/libs/chrome-frame/1.0.3/CFInstall.min.js"></script>
    <script defer>window.attachEvent('onload',function(){CFInstall.check({mode:'overlay'})})</script>
    <![endif]-->


  </body>
</html>
